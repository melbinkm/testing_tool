# Burp Suite MCP Server

MCP (Model Context Protocol) server for integrating with Burp Suite Professional's REST API. Provides proxy history retrieval, scanner findings, and evidence export capabilities for autonomous penetration testing workflows.

## Prerequisites

- Burp Suite Professional installed
- Burp REST API enabled (Settings -> Suite -> REST API)
- Node.js >= 20.0.0

## Setup

### Enable Burp REST API

1. Open Burp Suite Professional
2. Go to **Settings** (gear icon) -> **Suite** -> **REST API**
3. Check **Service running**
4. Set port (default: 1337)
5. Generate or set API key
6. Note the URL: `http://127.0.0.1:1337`

### Install Dependencies

```bash
cd mcp-servers/burp-mcp
npm install
```

### Build

```bash
npm run build
```

## Configuration

Set the following environment variables:

| Variable | Description | Default |
|----------|-------------|---------|
| `BURP_API_URL` | Burp REST API URL | `http://127.0.0.1:1337` |
| `BURP_API_KEY` | API key for authentication | (empty) |

## Running

```bash
BURP_API_URL=http://127.0.0.1:1337 BURP_API_KEY=your-api-key npm run start
```

## Available Tools

### burp_get_history

Retrieve Burp Suite proxy history.

**Parameters:**
- `limit` (optional, number): Maximum number of history items to return (default: 50)
- `host_filter` (optional, string): Filter by host (partial match)

**Example Response:**
```json
{
  "count": 2,
  "items": [
    {
      "index": 1,
      "method": "GET",
      "host": "example.com",
      "path": "/api/users",
      "status": 200,
      "length": 1234,
      "time": "2024-01-15T10:30:00Z"
    }
  ]
}
```

### burp_get_findings

Retrieve passive scanner findings from Burp Suite.

**Parameters:**
- `severity_filter` (optional, string): Filter by severity (high, medium, low, information)

**Example Response:**
```json
{
  "count": 1,
  "issues": [
    {
      "serial": "1234567890",
      "name": "SQL Injection",
      "host": "example.com",
      "path": "/api/users",
      "severity": "high",
      "confidence": "certain",
      "detail": "Parameter 'id' is vulnerable..."
    }
  ]
}
```

### burp_export_evidence

Export a proxy history item as evidence with full request/response details.

**Parameters:**
- `history_index` (required, number): Index of the history item to export

**Example Response:**
```json
{
  "success": true,
  "evidence": {
    "history_index": 1,
    "host": "example.com",
    "method": "GET",
    "path": "/api/users",
    "status": 200,
    "timestamp": "2024-01-15T10:30:00Z",
    "request_raw": "GET /api/users HTTP/1.1...",
    "response_raw": "HTTP/1.1 200 OK...",
    "request_headers": { "host": "example.com" },
    "response_headers": { "content-type": "application/json" },
    "correlation_ids": {
      "engagement_id": "ENG-001",
      "action_id": "ACT-123"
    }
  }
}
```

### burp_scope_check

Check if a URL is in Burp Suite target scope.

**Parameters:**
- `url` (required, string): URL to check

**Example Response:**
```json
{
  "url": "https://example.com/api",
  "in_scope": true
}
```

### burp_get_status

Get Burp Suite connection status and version.

**Parameters:** None

**Example Response:**
```json
{
  "connected": true,
  "version": "2024.1.1",
  "api_url": "http://127.0.0.1:1337"
}
```

## MCP Server Configuration

Add to your MCP settings (e.g., `.gemini/settings.json`):

```json
{
  "mcpServers": {
    "burp": {
      "command": "node",
      "args": ["mcp-servers/burp-mcp/dist/server.js"],
      "env": {
        "BURP_API_URL": "http://127.0.0.1:1337",
        "BURP_API_KEY": "${BURP_API_KEY}"
      },
      "timeout": 60000,
      "trust": false,
      "includeTools": [
        "burp_get_history",
        "burp_get_findings",
        "burp_export_evidence",
        "burp_scope_check",
        "burp_get_status"
      ]
    }
  }
}
```

## Testing

```bash
# Run unit tests
npm run test

# Type checking
npm run typecheck
```

## Integration with HTTP Client

When using with the HTTP client MCP server, requests sent through Burp proxy will include correlation headers:

- `X-Engagement-ID`: Links request to engagement
- `X-Action-ID`: Links request to specific action
- `X-Identity-ID`: Links request to identity/session

These headers appear in Burp history and are extracted by the evidence exporter for audit trails.

## Development

### Project Structure

```
src/
  burp-api-client.ts      # Burp REST API client
  burp-api-client.test.ts # Client tests
  evidence-exporter.ts    # Evidence export functionality
  evidence-exporter.test.ts
  server.ts               # MCP server entry point
  server.test.ts
```

### Building

```bash
npm run build
```

### Running Tests

```bash
npm run test
```
