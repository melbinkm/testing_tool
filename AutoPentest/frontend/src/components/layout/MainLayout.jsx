import { Outlet } from 'react-router-dom';
import { Layout } from 'antd';
import Sidebar from './Sidebar';
import GlobalSearch from '../common/GlobalSearch';
import { useState } from 'react';
import { useTheme } from '../../contexts/ThemeContext';

const { Header, Content } = Layout;

const MainLayout = () => {
  const [sidebarExpanded, setSidebarExpanded] = useState(false);
  const { isDark } = useTheme();

  return (
    <Layout style={{ minHeight: '100vh' }}>
      {/* Sidebar - Fixed */}
      <div style={{ position: 'fixed', left: 0, top: 0, bottom: 0, zIndex: 50 }}>
        <Sidebar onToggle={setSidebarExpanded} />
      </div>

      {/* Main content */}
      <Layout
        style={{
          marginLeft: sidebarExpanded ? 256 : 64,
          transition: 'margin-left 0.3s',
        }}
      >
        {/* Top bar */}
        <Header
          style={{
            position: 'sticky',
            top: 0,
            zIndex: 40,
            height: 56,
            padding: '0 24px',
            display: 'flex',
            alignItems: 'center',
            justifyContent: 'space-between',
            borderBottom: `1px solid ${isDark ? '#404040' : '#e5e5e5'}`,
            backdropFilter: 'blur(8px)',
            backgroundColor: isDark ? 'rgba(23,23,23,0.95)' : 'rgba(255,255,255,0.95)',
          }}
        >
          <div style={{ flex: 1, maxWidth: 640 }}>
            <GlobalSearch />
          </div>

          <div style={{ display: 'flex', alignItems: 'center', gap: 12 }}>
            <span
              style={{
                fontSize: 12,
                color: isDark ? '#a3a3a3' : '#737373',
                padding: '4px 8px',
                borderRadius: 4,
                cursor: 'default',
              }}
            >
              Ctrl+K to search
            </span>
          </div>
        </Header>

        {/* Page content */}
        <Content style={{ padding: 24 }}>
          <Outlet />
        </Content>
      </Layout>
    </Layout>
  );
};

export default MainLayout;
