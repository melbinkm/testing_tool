-- Add structured finding fields to cards table
-- Idempotent migration script - safe to run multiple times
-- Run via: docker exec autopentest-backend psql -U autopentest -d autopentest -f /app/scripts/add_finding_columns.sql

ALTER TABLE cards ADD COLUMN IF NOT EXISTS cvss_vector VARCHAR(255);
ALTER TABLE cards ADD COLUMN IF NOT EXISTS cvss_score DOUBLE PRECISION;
ALTER TABLE cards ADD COLUMN IF NOT EXISTS affected_endpoints TEXT;
ALTER TABLE cards ADD COLUMN IF NOT EXISTS description TEXT;
ALTER TABLE cards ADD COLUMN IF NOT EXISTS attack_scenario TEXT;
ALTER TABLE cards ADD COLUMN IF NOT EXISTS recommendation TEXT;
ALTER TABLE cards ADD COLUMN IF NOT EXISTS evidence TEXT;
