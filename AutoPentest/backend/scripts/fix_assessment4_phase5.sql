-- Fix Assessment 4 Phase 5 status: mark as "done" instead of "in_progress"
-- Run with: docker exec -i autopentest_postgres psql -U autopentest -d autopentest_db < backend/scripts/fix_assessment4_phase5.sql

-- Show current state
SELECT assessment_id, title, steps->4->>'status' AS phase5_status
FROM wm_plans
WHERE assessment_id = 4 AND title = 'Assessment Phase Orchestration';

-- Update Phase 5 (index 4) to done
UPDATE wm_plans
SET steps = jsonb_set(
    jsonb_set(steps, '{4,status}', '"done"', false),
    '{4,result}', '"Phase completed."', false
)
WHERE assessment_id = 4 AND title = 'Assessment Phase Orchestration';

-- Verify
SELECT assessment_id, title, steps->4->>'status' AS phase5_status
FROM wm_plans
WHERE assessment_id = 4 AND title = 'Assessment Phase Orchestration';
