rules:
  - id: pickle-loads
    patterns:
      - pattern: pickle.loads(...)
      - pattern: pickle.load(...)
      - pattern: cPickle.loads(...)
      - pattern: cPickle.load(...)
    message: Pickle deserialization - potential arbitrary code execution
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: deserialization
      risk_level: critical

  - id: yaml-unsafe-load
    patterns:
      - pattern: yaml.load(...)
      - pattern: yaml.unsafe_load(...)
    message: Unsafe YAML loading - potential code execution
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: deserialization
      risk_level: critical

  - id: marshal-loads
    patterns:
      - pattern: marshal.loads(...)
      - pattern: marshal.load(...)
    message: Marshal deserialization - potential code execution
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: deserialization
      risk_level: critical

  - id: shelve-open
    patterns:
      - pattern: shelve.open(...)
    message: Shelve uses pickle internally - deserialization risk
    languages: [python]
    severity: WARNING
    metadata:
      sink_type: deserialization
      risk_level: high

  - id: json-parse-eval
    patterns:
      - pattern: eval($X)
    message: eval() used for parsing - potential injection
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      sink_type: deserialization
      risk_level: critical

  - id: java-objectinputstream
    patterns:
      - pattern: new ObjectInputStream(...)
    message: Java ObjectInputStream - deserialization vulnerability
    languages: [java]
    severity: ERROR
    metadata:
      sink_type: deserialization
      risk_level: critical
