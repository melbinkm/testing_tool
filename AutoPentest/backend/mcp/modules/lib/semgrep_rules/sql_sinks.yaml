rules:
  - id: raw-sql-execute
    patterns:
      - pattern: cursor.execute(...)
      - pattern: $DB.execute(...)
      - pattern: connection.execute(...)
    message: Raw SQL execution - potential SQL injection
    languages: [python]
    severity: WARNING
    metadata:
      sink_type: sql
      risk_level: high

  - id: raw-sql-query
    patterns:
      - pattern: $DB.query(...)
      - pattern: $DB.raw(...)
    message: Raw SQL query - potential SQL injection
    languages: [python, javascript, typescript]
    severity: WARNING
    metadata:
      sink_type: sql
      risk_level: high

  - id: raw-sql-string-format
    patterns:
      - pattern: |
          $QUERY = f"... {$VAR} ..."
          ...
          $DB.execute($QUERY, ...)
    message: String-formatted SQL query - SQL injection risk
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: sql
      risk_level: critical

  - id: sequelize-raw-query
    patterns:
      - pattern: sequelize.query(...)
      - pattern: $DB.sequelize.query(...)
    message: Sequelize raw query - potential SQL injection
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      sink_type: sql
      risk_level: high

  - id: knex-raw
    patterns:
      - pattern: knex.raw(...)
      - pattern: $DB.raw(...)
    message: Knex raw query - potential SQL injection
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      sink_type: sql
      risk_level: high
