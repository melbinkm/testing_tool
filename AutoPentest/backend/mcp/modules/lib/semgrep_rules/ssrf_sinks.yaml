rules:
  - id: ssrf-requests-get
    patterns:
      - pattern: requests.get(...)
      - pattern: requests.post(...)
      - pattern: requests.put(...)
      - pattern: requests.delete(...)
    message: HTTP request with potentially user-controlled URL - SSRF risk
    languages: [python]
    severity: WARNING
    metadata:
      sink_type: ssrf
      risk_level: high

  - id: ssrf-urllib
    patterns:
      - pattern: urllib.request.urlopen(...)
      - pattern: urllib.request.urlretrieve(...)
    message: urllib request - potential SSRF
    languages: [python]
    severity: WARNING
    metadata:
      sink_type: ssrf
      risk_level: high

  - id: ssrf-httpx
    patterns:
      - pattern: httpx.get(...)
      - pattern: httpx.post(...)
      - pattern: httpx.AsyncClient(...).get(...)
    message: httpx request - potential SSRF
    languages: [python]
    severity: WARNING
    metadata:
      sink_type: ssrf
      risk_level: high

  - id: ssrf-fetch
    patterns:
      - pattern: fetch(...)
    message: fetch() call - potential SSRF if URL is user-controlled
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      sink_type: ssrf
      risk_level: medium

  - id: ssrf-axios
    patterns:
      - pattern: axios.get(...)
      - pattern: axios.post(...)
      - pattern: axios(...)
    message: axios request - potential SSRF
    languages: [javascript, typescript]
    severity: WARNING
    metadata:
      sink_type: ssrf
      risk_level: high
