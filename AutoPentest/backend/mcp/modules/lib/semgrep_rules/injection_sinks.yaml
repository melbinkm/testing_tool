rules:
  - id: dangerous-eval
    patterns:
      - pattern: eval(...)
    message: Dangerous eval() call - potential code injection
    languages: [python, javascript, typescript, ruby, php]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-exec
    patterns:
      - pattern: exec(...)
    message: Dangerous exec() call - potential code injection
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-subprocess-shell
    patterns:
      - pattern: subprocess.call(..., shell=True, ...)
      - pattern: subprocess.run(..., shell=True, ...)
      - pattern: subprocess.Popen(..., shell=True, ...)
    message: Subprocess with shell=True - potential command injection
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-os-system
    patterns:
      - pattern: os.system(...)
    message: os.system() call - potential command injection
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-os-popen
    patterns:
      - pattern: os.popen(...)
    message: os.popen() call - potential command injection
    languages: [python]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-child-process-exec
    patterns:
      - pattern: child_process.exec(...)
      - pattern: child_process.execSync(...)
    message: child_process.exec() - potential command injection
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: critical

  - id: dangerous-function-constructor
    patterns:
      - pattern: new Function(...)
    message: Function constructor - potential code injection
    languages: [javascript, typescript]
    severity: ERROR
    metadata:
      sink_type: injection
      risk_level: high
